/**
 * almond 0.2.4 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 RequireJS text 1.0.2 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/*! jQuery UI - v1.10.1 - 2013-02-20
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.slider.js
* Copyright (c) 2013 jQuery Foundation and other contributors Licensed MIT */

/*
 * jQuery UI Touch Punch 0.2.2
 *
 * Copyright 2011, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */

/*
 * jQuery resize event - v1.1 - 3/14/2010
 * http://benalman.com/projects/jquery-resize-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

$.holdReady(!0);var requirejs,require,define;(function(e){function c(e,t){return f.call(e,t)}function h(e,t){var n,r,i,s,o,a,f,l,c,h,p=t&&t.split("/"),d=u.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))break;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=l;break}}}if(s)break;!a&&v&&v[r]&&(a=v[r],f=l)}!s&&a&&(s=a,o=f),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function p(t,r){return function(){return n.apply(e,l.call(arguments,0).concat([t,r]))}}function d(e){return function(t){return h(t,e)}}function v(e){return function(t){s[e]=t}}function m(n){if(c(o,n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!c(s,n)&&!c(a,n))throw new Error("No "+n);return s[n]}function g(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function y(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=Object.prototype.hasOwnProperty,l=[].slice;r=function(e,t){var n,r=g(e),i=r[0];return e=r[1],i&&(i=h(i,t),n=m(i)),i?n&&n.normalize?e=n.normalize(e,d(t)):e=h(e,t):(e=h(e,t),r=g(e),i=r[0],e=r[1],i&&(n=m(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return p(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:y(e)}}},t=function(t,n,u,f){var l,h,d,g,y,b=[],w;f=f||t;if(typeof u=="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(y=0;y<n.length;y+=1){g=r(n[y],f),h=g.f;if(h==="require")b[y]=i.require(t);else if(h==="exports")b[y]=i.exports(t),w=!0;else if(h==="module")l=b[y]=i.module(t);else if(c(s,h)||c(o,h)||c(a,h))b[y]=m(h);else{if(!g.p)throw new Error(t+" missing "+h);g.p.load(g.n,p(f,!0),v(h),{}),b[y]=s[h]}}d=u.apply(s[t],b);if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(d!==e||!w)s[t]=d}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){return typeof s=="string"?i[s]?i[s](o):m(r(s,o).f):(s.splice||(u=s,o.splice?(s=o,o=a,a=null):s=e),o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},4),n)},n.config=function(e){return u=e,n},define=function(e,t,n){t.splice||(n=t,t=[]),!c(s,e)&&!c(o,e)&&(o[e]=[e,t,n])},define.amd={jQuery:!0}})(),define("../libs/almond",function(){}),define("krusty-core/krusty-util/Url",[],function(){var e={};return e.getUrlVars=function(){var e={},t,n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var r=0;r<n.length;r++)t=n[r].split("="),e[t[0]]=t[1];return e},e}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?null:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;r.computed>o&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;i>n.call(r,e[u])?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);r>i;)s[i++]=e,e+=n;return s},x.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));var n=u.call(arguments,2);return function(){return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);return 0===t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var O=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(o=e.length,u=o==t.length)for(;o--&&(u=O(e[o],t[o],n,r)););}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(u=x.has(t,c)&&O(e[c],t[c],n,r))))break;if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return O(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=x.invert(M.escape);var _={escape:RegExp("["+x.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(M.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(_[e],function(t){return M[e][t]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,n.apply(x,e))}})};var D=0;x.uniqueId=function(e){var t=++D+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(B,function(e){return"\\"+H[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var j=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],j.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),define("krusty-core/krusty-util/Rand",[],function(){var e={};return e.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e}),define("krusty-core/springfield/bart/BartConnector",["underscore","krusty-core/krusty-util/Rand"],function(e,t){function n(n){var r=this,i={bartURI:"http://bart%number%.noterik.com/bart/",bart:t.getRandomInt(1,3)};return this.request=function(e){e.url=i.bartURI+e.url,$.ajax(e)},e.extend(i,n),i.bartURI=i.bartURI.replace("%number%",i.bart),r}return n}),define("krusty-core/springfield/bart/QuickStartConnector",["underscore","krusty-core/springfield/bart/BartConnector"],function(e,t){function n(n){var r={success:null,uri:null},i=t(),s={url:null,type:"POST",accepts:"text/xml",contentType:"text/xml",data:"<fsxml mimetype='application/fscommand' id='dynamic'><properties><handler>/dynamic/presentation/playout/flash</handler></properties></fsxml>"},o=function(){if(r.uri==null)throw"No URI given!";return!0},u=function(){typeof r.success=="function"&&(s.success=r.success),i.request(s)};e.extend(r,n),s.url=r.uri,o(),u()}return n}),define("krusty-core/krusty-util/AspectRatio",[],function(){var e={};return e.getAspectRatio=function(e,t){return e/t>=1.2&&e/t<=1.5?"4:3":e/t>=1.5&&e/t<=2.1?"16:9":e/t>=2.1&&e/t<=2.7?"2.35":"unknown"},e}),define("krusty-core/krusty-player/bart/QSResponseParser",["underscore","krusty-core/krusty-util/AspectRatio"],function(e,t){var n={};return n.parse=function(n){var r=[],i=$(n);return e.each(i.find("presentation > videoplaylist").first().find("video"),function(n){var s={};s.sources=[],n=$(n),n.find("starttime")!=null?s.start=$(n.find("starttime")).text()/1e3:s.start=0;if(n.find("duration")!=null){var o=0;s.start!=undefined&&(o=s.start),s.stop=o+$(n.find("duration")).text()/1e3}var u=$(i.find('fsxml > video[fullid|="'+n.attr("referid")+'"]'));u.find("properties > anamorphic").text()=="1.33"&&(s.anamorphic=!0);var a="16:9",f=$(e.find($(i.find('fsxml > video[fullid|="'+n.attr("referid")+'"] > rawvideo')),function(e){return $(e).find("original").first().text()=="true"}));f!=null&&(a=t.getAspectRatio(f.find("width").text(),f.find("height").text()),a!=null&&s.anamorphic&&(a=="4:3"?a="4:3ana16:9":a=="16:9"&&(a="16:9ana2.35"))),s.aspectRatio=a;if(u.children("rawvideo").length>1)e.each(u.children("rawvideo"),function(t){if(!$(t).find("original").text()&&$(t).find("wantedheight").text()!=""){var n=!1,r=e.find(s.sources,function(e){return e.quality==$(t).find("wantedheight").text()});if(r==null){var n=!0;r={}}r.quality=$(t).find("height").text()+"p",r.codecs==undefined&&(r.codecs=[]);var i={};switch($(t).find("extension").text()){case"mp4":i.type="video/mp4"}var o=$(t).find("mount").text().split(",")[0];i.src="http://"+o+".noterik.com/progressive/"+o+u.attr("fullid")+"/rawvideo/"+$(t).attr("id")+"/raw.mp4",r.codecs.push(i),n&&s.sources.push(r)}else $(t).find("mount").text()=="youtube"&&(s.type="video/youtube",s.youtubeid=$(t).find("id").text(),s.availableQualities=["360p","480p","720p"])});else{var l=u.find("rawvideo").first(),c={};c.quality="720",c.codecs=[];var h={};switch($(l).find("extension").text()){case"mp4":h.type="video/mp4"}var p=$(l).find("mount").text().split(",")[0];h.src="http://"+p+".noterik.com/progressive/"+p+u.attr("fullid")+"/rawvideo/"+$(l).attr("id")+"/raw.mp4",c.codecs.push(h),s.sources.push(c)}var d=u.find("screens").first();s.screenshots=d.find("uri").text(),r.push(s)}),r},n}),define("krusty-core/springfield/bart/BartResponseParser",["underscore"],function(e){function t(t){var n={nic:null,response:null,uri:null},r=function(e,t){t==null&&(t=n.uri),e.children().each(function(e,i){if(i.nodeName=="properties")$(i).children().each(function(e,r){var i=r.nodeName;n.nic.put(t+"/properties/"+i,$(r).text())});else{var s=i.nodeName,o=$(i).attr("id");o==undefined&&(o=""),n.nic.put(t+"/"+s,null),n.nic.put(t+"/"+s+"/"+o,null),r($(i),t+"/"+s+"/"+o)}})};return e.extend(n,t),{parse:function(){n.response instanceof jQuery||(n.response=$(n.response));var e=n.response.find("fsxml");if(e==null)throw"Response does not contain fsxml.";r(n.response.find("fsxml"),null)}}}return t}),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.0.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=o.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,i,o,a,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(e[n],t)))continue;(f=this.get(o))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(o.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o))}if(t.remove){for(n=0,i=this.length;n<i;++n)m[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?s.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=d.length;n<i;n++)(o=d[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||B()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var H=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["underscore"],function(e){return function(){return e.Backbone}}(this)),define("krusty-core/krusty-gui/libs/tmpl",[],function(){var e=function(){var e={};this.tmpl=function t(n,r){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[n]=e[n]||t(document.getElementById(n).innerHTML);return r?i(r):i}},t=new e;return t.tmpl}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||void 0),u=[];define("libs/text",[],function(){var a,f,l;return typeof window!="undefined"&&window.navigator&&window.document?f=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(l=require.nodeRequire("fs"),f=function(e,t){t(l.readFileSync(e,"utf8"))}):typeof Packages!="undefined"&&(f=function(e,t){var n=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),n=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),i,s,o="";try{i=new java.lang.StringBuffer,(s=n.readLine())&&s.length()&&s.charAt(0)===65279&&(s=s.substring(1));for(i.append(s);(s=n.readLine())!==null;)i.append(r),i.append(s);o=String(i.toString())}finally{n.close()}t(o)}),a={version:"1.0.2",strip:function(e){if(e){var e=e.replace(t,""),r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw Error("createXhr(): XMLHttpRequest not available");return t},get:f,parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),e=e.substring(n+1,e.length),n=e.indexOf("!");return n!==-1&&(t=e.substring(n+1,e.length),t=t==="strip",e=e.substring(0,n)),{moduleName:r,ext:e,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s;return i?(e=i[2],i=i[3],i=i.split(":"),s=i[1],i=i[0],(!e||e===t)&&(!i||i===n)&&(!s&&!i||s===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&(u[e]=n),r(n)},load:function(e,t,n,u){if(u.isBuild&&!u.inlineText)n();else{var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})}},write:function(e,t,n){if(t in u){var r=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,n,r,i){var t=a.parseName(t),s=t.moduleName+"."+t.ext,o=n.toUrl(t.moduleName+"."+t.ext)+".js";a.load(s,n,function(){var t=function(e){return r(o,e)};t.asModule=function(e,t){return r.asModule(e,o,t)},a.write(e,s,t,i)},i)}}})}(),define("libs/text!app/gui-components/templates/gui.component.template.html",[],function(){return"&nbsp;"}),define("config",[],function(){var e={debug:!1,debug_level:3,img_location:"/eddie/img/spatialspotting/",gui_container:"krusty_presentation"};return e}),define("krusty-core/krusty-gui/GUIComponentBase",["krusty-core/krusty-gui/libs/tmpl","libs/text!app/gui-components/templates/gui.component.template.html","config"],function(e,t,n){function r(r){var i=this,s={element:$(document.createElement("div")),template:t,context:null,children:[],parent:null,templateContents:{},imgLocation:n.img_location};return _.extend(s,r),{getElement:function(){return s.element},setDimensions:function(e){s.element.width(e.width),s.element.height(e.height)},getDimensions:function(){return{width:s.element.width(),height:s.element.height()}},setTemplate:function(e){s.template=e},getTemplate:function(){return s.template},setTemplateContents:function(e){s.templateContents=e},getTemplateContents:function(){return s.templateContents},setTmplValue:function(e,t){s.templateContents[e]=t},setContext:function(e){s.context=e},getContext:function(){return s.context},getImgLocation:function(){return s.imgLocation},setParent:function(e){s.parent=e},getParent:function(){return s.parent},addChild:function(e){s.children[s.children.length]=e},getChildren:function(e){return e!=null?$(_.filter(s.children,function(t){return t.getElement().is(e)})):s.children},render:function(){s.element.html(e(s.template,s.templateContents))},contextReady:function(){},on:function(e,t){s.element.on(e,t)},trigger:function(e){s.element.trigger(e)},show:function(){s.element.show()},hide:function(){s.element.hide()},isVisible:function(){return s.element.is(":visible")},width:function(e){return s.element.width.apply(s.element,arguments)},height:function(e){return s.element.height.apply(s.element,arguments)},css:function(){return s.element.css.apply(s.element,arguments)}}}return r}),define("libs/text!app/gui-components/templates/gui.component.presentation.template.html",[],function(){return'<div class="viewport">\n</div>\n<div class="screenshot-mask">\n</div>\n<div class="controls">\n	&nbsp;\n</div>\n<div id="youtube-container">\n	<div id="youtube-player">&nbsp;</div>\n</div>\n'}),define("app/gui-components/GUIPresentation",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.presentation.template.html"],function(e,t){function n(n){return self=e(n),self.setTemplate(t),self.contextReady=function(){this.getChildren(".viewport")[0].setHeightOffset(this.getChildren(".controls")[0].getDimensions().height),this.getContext().get(".screenshot-mask")[0].setHeightOffset(this.getChildren(".controls")[0].getDimensions().height)},self.resize=function(){this.getChildren(".viewport")[0].setHeightOffset(this.getChildren(".controls")[0].getDimensions().height),this.getContext().get(".screenshot-mask")[0].setHeightOffset(this.getChildren(".controls")[0].getDimensions().height)},self}return n}),define("krusty-core/krusty-gui/GUIScalableMaskComponent",["krusty-core/krusty-gui/GUIComponentBase","krusty-core/krusty-util/AspectRatio"],function(e,t){function n(n){var r=e(n),i={pHeight:0,pWidth:0,displayArea:null,heightOffset:0,widthOffset:0,mode:"auto",inputRenderingMapping:{"4:3ana16:9":"_render43Anamorphic",unknown:"_render169","16:9":"_render169","4:3":"_render43",2.35:"_render235","16:9ana2.35":"_render169Anamorphic"},wantedRatio:"16:9",givenRatio:"16:9"};r.setWantedRatio=function(e){e!=null&&(i.wantedRatio=e),this.resize()},r.getWantedRatio=function(){return i.wantedRatio},r.setGivenRatio=function(e){i.givenRatio=e},r.getGivenRatio=function(){return i.givenRatio},r.setHeightOffset=function(e){i.heightOffset=e},r.getHeightOffset=function(){return i.heightOffset},r.setWidthOffset=function(e){i.widthOffset=e},r.getWidthOffset=function(){return i.widthOffset},r.setMode=function(e){i.mode=e},r.getMode=function(){return i.mode},r.setDisplayArea=function(e){i.displayArea=e},r.getDisplayArea=function(){return i.displayArea},r.resize=function(){i.pHeight=this.getElement().parent().height()-i.heightOffset,i.pWidth=this.getElement().parent().width()-i.widthOffset,i.displayArea!=null&&(i.mode=="auto"?this[i.inputRenderingMapping[i.wantedRatio]]():o())};var s=function(){r.getElement().css("position","absolute"),r.getElement().css("left",0),r.getElement().css("top",0),r.getElement().css("bottom",0),i.displayArea.css("position","absolute"),i.displayArea.css("left",0),i.displayArea.css("top",0),i.displayArea.css("bottom",0)},o=function(){s(),r.getElement().height(i.pHeight),r.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight)};return r._render43Anamorphic=function(){switch(t.getAspectRatio(i.pWidth,i.pHeight)){case"4:3":s(),this.getElement().width(i.pWidth),this.getElement().height(i.pWidth/16*9),this.getElement().css("top",(i.pHeight-this.getElement().height())/2),i.displayArea.width(i.pWidth),i.displayArea.height(i.pWidth/4*3),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"16:9":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight*1.33),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"2.35":s(),this.getElement().width(i.pHeight/9*16),this.getElement().height(i.pHeight),this.getElement().css("left",(i.pWidth-this.getElement().width())/2),i.displayArea.width(this.getElement().width()),i.displayArea.height(i.pHeight*1.33),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"unknown":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight)}},r._render169=function(){switch(t.getAspectRatio(i.pWidth,i.pHeight)){case"4:3":s(),this.getElement().width(i.pWidth),this.getElement().height(i.pWidth/16*9),this.getElement().css("top",(i.pHeight-this.getElement().height())/2),i.displayArea.width(this.getElement().width()),i.displayArea.height(this.getElement().height());break;case"16:9":s(),this.getElement().width(i.pWidth),this.getElement().height(i.pHeight),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight);break;case"2.35":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pHeight/9*16),this.getElement().css("left",(i.pWidth-this.getElement().width())/2),i.displayArea.width(i.pHeight/9*16),i.displayArea.height(i.pHeight);break;case"unknown":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight)}},r._render43=function(){switch(t.getAspectRatio(i.pWidth,i.pHeight)){case"4:3":s(),this.getElement().width(i.pWidth),this.getElement().height(i.pHeight),i.displayArea.height(i.pHeight),i.displayArea.width(i.pWidth);break;case"16:9":s(),this.getElement().width(i.pHeight/3*4),this.getElement().height(i.pHeight),this.getElement().css("left",(i.pWidth-this.getElement().width())/2),i.displayArea.width(this.getElement().width()),i.displayArea.height(this.getElement().height());break;case"2.35":s(),this.getElement().width(i.pHeight/3*4),this.getElement().height(i.pHeight),this.getElement().css("left",(i.pWidth-this.getElement().width())/2),i.displayArea.width(this.getElement().width()),i.displayArea.height(this.getElement().height());break;case"unknown":s(),this.getElement().width(i.pWidth),this.getElement().height(i.pHeight),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight)}},r._render169Anamorphic=function(){switch(t.getAspectRatio(i.pWidth,i.pHeight)){case"4:3":s(),this.getElement().height(i.pWidth/16*9/1.33),this.getElement().width(i.pWidth),this.getElement().css("top",(i.pHeight-this.getElement().height())/2),i.displayArea.width(i.pWidth),i.displayArea.height(i.pWidth/16*9),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"16:9":s(),this.getElement().height(i.pWidth/2.35),this.getElement().width(i.pWidth);var e=(i.pHeight-this.getElement().height())/2;this.getElement().css("top",e),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"2.35":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight*1.33),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"unknown":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight)}},r._render235=function(){switch(t.getAspectRatio(i.pWidth,i.pHeight)){case"4:3":s(),this.getElement().width(i.pWidth),this.getElement().height(i.pWidth/2.35),this.getElement().css("top",(i.pHeight-this.getElement().height())/2),i.displayArea.width(i.pWidth),i.displayArea.height(i.pWidth/2.35),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"16:9":s(),this.getElement().width(i.pWidth),this.getElement().height(i.pWidth/2.35),this.getElement().css("top",(i.pHeight-this.getElement().height())/2),i.displayArea.width(i.pWidth),i.displayArea.height(i.pWidth/2.35),i.displayArea.css("top",-(i.displayArea.height()-this.getElement().height())/2);break;case"2.35":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight);break;case"unknown":s(),this.getElement().height(i.pHeight),this.getElement().width(i.pWidth),i.displayArea.width(i.pWidth),i.displayArea.height(i.pHeight)}},r}return n}),define("libs/text!app/gui-components/templates/gui.component.viewport.template.html",[],function(){return'<div class="dialog" id="dialog">\n</div>\n<div class="playback">\n</div>\n'}),define("app/gui-components/GUIViewport",["krusty-core/krusty-gui/GUIScalableMaskComponent","libs/text!app/gui-components/templates/gui.component.viewport.template.html"],function(e,t){function n(n){var r=e(n);return r.setTemplate(t),r.contextReady=function(){this.setDisplayArea(this.getChildren(".playback")[0])},r}return n}),define("libs/text!app/gui-components/templates/gui.component.controls.template.html",[],function(){return'<div class="control-bar">\n	<div id="play-button" class="button button-size-small button-icon-play button-toggled-icon-pause">\n		&nbsp;\n	</div>\n	\n	<div class="scrubber">\n		&nbsp;\n	</div>\n	<div class="timer">\n		&nbsp;\n	</div>\n\n	<!--\n	<div id="quality-button" class="button button-size-large button-icon-360p">\n		&nbsp;\n	</div>\n	-->\n</div>\n<!--\n<div id="quality-selector" class="quality-selector">\n	&nbsp;\n</div>\n-->'}),define("app/gui-components/GUIControls",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.controls.template.html"],function(e,t){function n(n){return self=e(n),self.setTemplate(t),self.contextReady=function(){var e=this.getChildren("#play-button")[0],t=this.getChildren("#volume-button")[0],n=this.getChildren("#quality-button")[0],r=this.getChildren("#quality-selector")[0],i=this.getChildren("#volume-control")[0],s=this,o=null,u=null;this.setQuality=function(e){if(n){var t={"180p":{cls:"button-icon-180p",img:"button-icons/180p.png"},"360p":{cls:"button-icons-360p",img:"button-icons/360p.png"},"480p":{cls:"button-icons-480p",img:"button-icons/480p.png"},"720p":{cls:"button-icons-720p",img:"button-icons/720p.png"},"1080p":{cls:"button-icon-1080p",img:"button-icons/1080p.png"}},r=n.getElement();r.removeClass(r.attr("class").substring(r.attr("class").match(/\bbutton-icon/).index).split(" ")[0]),r.addClass(t[e].cls),r.find("img").attr("src",self.getImgLocation()+t[e].img)}},this.hide=function(){u=this.getElement().height(),this.getElement().height(0),this.getElement().hide(),this.getContext().resize()},this.show=function(){this.getElement().height(u),this.getElement().show(),this.getContext().resize()},e&&e.on("click",function(){e.isToggled()?s.trigger("pause-button-clicked"):s.trigger("play-button-clicked"),e.toggle()}),t&&(t.on("click",function(){t.isToggled()?s.trigger("unmute-button-clicked"):s.trigger("mute-button-clicked"),t.toggle()}),t.on("mouseover",function(){i.isVisible()||(i.show(),clearTimeout(o))}),t.on("mouseleave",function(){o=setTimeout(function(){i.hasFocus()||i.hide()},1e3)})),n&&(n.on("click",function(){r.show(),s.trigger("quality-button-clicked")}),$(window).on("click",function(e){$(e.target).parent().parent().attr("id")!="quality-button"&&r.hide()}))},self.getElement().on("touchstart",function(e){e.preventDefault()}),self}return n}),define("libs/text!app/gui-components/templates/gui.component.screenshot.template.html",[],function(){return"<img />"}),define("app/gui-components/GUIScreenshot",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.screenshot.template.html"],function(e,t){function n(n){var r=e(n);r.setTemplate(t);var i,s=document.createElement("img"),o=!1;return r.setScreenshot=function(e){s.src=e;var t=this;o||(blockResize=!0,setTimeout(function(){o=!1},100),$(s).load(function(){i=s,t.getElement().html(i),t._resizeScreenshot()}))},r._resizeScreenshot=function(){var e=r.getDimensions().height,t=r.getDimensions().width;$(i).width(t),$(i).height(e)},r.resize=function(){this._resizeScreenshot()},r}return n}),define("libs/text!app/gui-components/templates/gui.component.playback.template.html",[],function(){return"&nbsp;"}),define("app/gui-components/GUIPlayback",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.playback.template.html"],function(e,t){function n(n){var r=this;return $.extend(r,new e(n)),r.setTemplate(t),r.setVideoElement=function(e){$(this.getElement()).find("video").length>0&&$(this.getElement()).find("video").first().detach(),$(this.getElement()).html(e[0]),this._resizeVideoElement()},r._resizeVideoElement=function(){var e=this,t=$(this.getElement()).find("video, iframe").first();if(t.length>0){var n=function(){var r=e.getDimensions().height,i=e.getDimensions().width;if(t[0].tagName=="VIDEO")if(t[0].readyState>0){t.attr("height",t[0].videoHeight),t.attr("width",t[0].videoWidth);var s=t[0].videoHeight,o=t[0].videoWidth,u=i/o,a=r/s,f=o*u,l=s*a;t.css("transform","scale("+u+", "+a+")"),t.css("transform-origin","0 0"),t.css("-webkit-transform","scale("+u+", "+a+")"),t.css("-webkit-transform-origin","0 0"),t.css("-moz-transform","scale("+u+", "+a+")"),t.css("-moz-transform-origin","0 0"),t.css("-ms-transform","scale("+u+", "+a+")"),t.css("-ms-transform-origin","0 0"),t.css("-o-transform","scale("+u+", "+a+")"),t.css("-o-transform-origin","0 0")}else t.on("loadedmetadata",n);else t[0].tagName=="IFRAME"&&(t.attr("width",i),t.attr("height",r))};n()}},r.resize=function(){this._resizeVideoElement()},r}return n}),define("libs/text!app/gui-components/templates/gui.component.dialog.template.html",[],function(){return'<div class="indicator">\n	<img src="" />\n</div>\n<div class="message">\n	<span>&nbsp;</span>\n</div>'}),define("app/gui-components/GUIDialog",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.dialog.template.html"],function(e,t){function n(n){self=e(n),self.setTemplate(t);var r=null,i={play:{src:"dialog-icons/play.png",width:50,height:50},loading:{src:"dialog-icons/ajax-loader.gif",width:32,height:32},error:{src:"",width:32,height:32}},s=null,o=null,u=null;return self.contextReady=function(){o=this.getElement().find(".indicator"),u=this.getElement().find(".message");var e=this;o.on("click",function(){e.getContext().trigger("click",e)})},self._renderIndicator=function(){var e=o.find("img");e[0].src=self.getImgLocation()+r.src,e[0].width=r.width==undefined?o.width():r.width,e[0].height=r.height==undefined?o.height():r.height,e[0].width<o.width()&&$(e[0]).css("left",(o.width()-e[0].width)/2),e[0].height<o.height()&&$(e[0]).css("top",(o.height()-e[0].height)/2)},self.setIndicator=function(e){s=e,i[e]!=null&&(r=i[e]),this._renderIndicator()},self.getState=function(){return s},self.setMessage=function(e){var t=document.createElement("span");$(t).html(e),u.html(t)},self}return n}),define("libs/text!app/gui-components/templates/gui.component.scrubber.template.html",[],function(){return'<div class="scrubber-position-wrapper">\n	\n	<!--<div data-role="fieldcontain">\n		<input type="range" name="slider" id="slider-0" value="0" min="0" max="1000" step="100" data-highlight="true"/>\n	</div>-->\n	<div class="slider"></div>\n</div>'}),function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,!t.href||!s||i.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var i=0,s=/^ui-id-\d+$/;e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.10.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){return e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),i&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var s=r==="Width"?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})}(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.1",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];n=r.values&&r.values.length||1,i.length>n&&(i.slice(n).remove(),i=i.slice(0,n));for(t=i.length;t<n;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&t.values.length!==2?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),!this.range||!this.range.length?(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"):this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}),this.range.addClass(n+(t.range==="min"||t.range==="max"?" ui-slider-range-"+t.range:""))):this.range=e([])},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));if(i>n||i===n&&(t===l._lastChangedValue||l.values(t)===c.min))i=n,s=e(this),o=t}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return this.orientation==="horizontal"?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),r<0&&(r=0),this.orientation==="vertical"&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values,i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;t==="range"&&this.options.range===!0&&(n==="min"?(this.options.value=this._values(0),this.options.values=null):n==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e),e},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t),t;if(this.options.values&&this.options.values.length){n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return Math.abs(n)*2>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100,l[a.orientation==="horizontal"?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&(a.orientation==="horizontal"?(r===0&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(r===0&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?(r-i)/(s-i)*100:0,l[this.orientation==="horizontal"?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),o==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),o==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),o==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),o==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(t){var r,i,s,o,u=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:t.preventDefault();if(!this._keySliding){this._keySliding=!0,e(t.target).addClass("ui-state-active"),r=this._start(t,u);if(r===!1)return}}o=this.options.step,this.options.values&&this.options.values.length?i=s=this.values(u):i=s=this.value();switch(t.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(t,u,s)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),define("libs/jquery-ui",function(){}),function(e){function i(e,t){if(e.originalEvent.touches.length>1)return;e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}e.support.touch="ontouchend"in document;if(!e.support.touch)return;var t=e.ui.mouse.prototype,n=t._mouseInit,r;t._touchStart=function(e){var t=this;if(r||!t._mouseCapture(e.originalEvent.changedTouches[0]))return;r=!0,t._touchMoved=!1,i(e,"mouseover"),i(e,"mousemove"),i(e,"mousedown")},t._touchMove=function(e){if(!r)return;this._touchMoved=!0,i(e,"mousemove")},t._touchEnd=function(e){if(!r)return;i(e,"mouseup"),i(e,"mouseout"),this._touchMoved||i(e,"click"),r=!1},t._mouseInit=function(){var t=this;t.element.bind("touchstart",e.proxy(t,"_touchStart")).bind("touchmove",e.proxy(t,"_touchMove")).bind("touchend",e.proxy(t,"_touchEnd")),n.call(t)}}(jQuery),define("libs/jquery.ui.touch-punch.min",function(){}),define("app/gui-components/GUIScrubber",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.scrubber.template.html","libs/jquery-ui","libs/jquery.ui.touch-punch.min"],function(e,t){function n(n){self=e(n),self.setTemplate(t);var r=null,i=!1,s=0;return self.render=function(){self.getElement().html(self.getTemplate());var e=self.getElement();r=e.find(".slider");var t=e.parent(),n=0;r.slider({min:0,max:1e3,step:1,range:"min"}),r.find("a.ui-slider-handle").append("<div></div>"),_.each(t.children(),function(t){t!=e[0]&&(n+=$(t).outerWidth(!0))});var o=Math.floor(t.width()-n-parseInt(e.css("border-left-width"))-parseInt(e.css("border-right-width"))-7);this.getElement().on("touchstart",function(e){e.preventDefault()}),r.on("slidestart",function(e){i=!0,self.getContext().trigger("scrubstart")}),r.on("slidestop",function(e){i=!1,self.getContext().trigger("scrubstop",r.slider("option","value")/10)}),r.on("slide",function(e){i&&r.slider("option","value")!=s&&(s=r.slider("option","value"),self.getContext().trigger("scrub",s/10))})},self.resize=function(){var e=this.getElement(),t=e.parent(),n=0;_.each(t.children(),function(t){t!=e[0]&&(n+=$(t).outerWidth(!0))}),e.width(Math.floor(t.width()-n-parseInt(e.css("border-left-width"))-parseInt(e.css("border-right-width"))-7))},self.move=function(e){r.slider("option","value",e*10)},self}return n}),define("libs/text!app/gui-components/templates/gui.component.quality.template.html",[],function(){return'<div id="quality-1080p" class="button button-size-large button-icon-1080p">&nbsp;</div>\n<div id="quality-720p" class="button button-size-large button-icon-720p">&nbsp;</div>\n<div id="quality-480p" class="button button-size-large button-icon-480p">&nbsp;</div>\n<div id="quality-360p" class="button button-size-large button-icon-360p">&nbsp;</div>\n<div id="quality-180p" class="button button-size-large button-icon-180p">&nbsp;</div>\n'}),define("app/gui-components/GUIQualitySelector",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.quality.template.html"],function(e,t){function n(n){return self=e(n),self.setTemplate(t),self.setAvailableQualities=function(e){var t="#quality-selector > .button:not(",n=0;_.each(e,function(e){n!=0&&(t+=", "),t+=".button-icon-"+e,n++}),t+=")",$(t).hide()},self.contextReady=function(){},self}return n}),define("libs/text!app/gui-components/templates/gui.component.button.template.html",[],function(){return'<div class="button-component-icon">\n	<img />\n</div>'}),define("app/gui-components/GUIButton",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.button.template.html"],function(e,t){function n(n){self=e(n),self.setTemplate(t);var r={play:{img:"sprites/bg_sprite.png",x:"0",y:"-229px"},pause:{img:"sprites/bg_sprite.png",x:"-44px",y:"-229px"}},i={},s=!1;return self._parseSettings=function(){var e=this.getElement(),t=_.find(e[0].className.split(" "),function(e){return e.indexOf("button-icon")!=-1}),n=_.find(e[0].className.split(" "),function(e){return e.indexOf("button-toggled-icon")!=-1});t!=null&&(i.icon=t.substring(12)),n!=null&&(i.toggledIcon=n.substring(20))},self._renderIcon=function(){var e=this.getElement(),t=r[i.icon];if(i.toggledIcon!=null){var n=r[i.toggledIcon];s?e.css("background","url("+self.getImgLocation()+n.img+") "+n.x+" "+n.y):e.css("background","url("+self.getImgLocation()+t.img+") "+t.x+" "+t.y)}else e.css("background","url("+self.getImgLocation()+t.img+") "+t.x+" "+t.y)},self._touchStart=function(e,t){this.trigger("mousedown",t)},self._touchEnd=function(e,t){this.trigger("mouseup",t)},self._mouseDown=function(e,t){this.getElement().find(".button").addClass("button-mousedown")},self._mouseUp=function(e,t){this.getElement().find("button").removeClass("button-mousedown")},self._click=function(e,t){this.getContext().trigger("click",this)},self._listenToTouchEvents=function(){var e=this;this.on("touchstart",function(t){e._touchStart(e,t)}),this.on("touchend",function(t){e._click(e,t)})},self._listenToElementEvents=function(){var e=this;this.on("mousedown",function(t){e._mouseDown(e,t)}),this.on("mouseup",function(t){e._mouseUp(e,t)}),this.on("click",function(t){e._click(e,t)})},self.setToggled=function(e){s=e,this._renderIcon()},self.toggle=function(){return s=!s,this._renderIcon(),s},self.render=function(){this.getElement().html(t),this._parseSettings(),this._renderIcon()},self.isToggled=function(){return s},self.resize=function(){this._renderIcon()},self._listenToElementEvents(),self._listenToTouchEvents(),self}return n}),define("krusty-core/krusty-util/Time",[],function(){var e={};return e.parseTime=function(e,t){var n=Math.floor(e/3600),r=Math.floor((e-n*3600)/60),i=Math.floor(e-n*3600-r*60);n<10&&(n="0"+n),r<10&&(r="0"+r),i<10&&(i="0"+i);if(t!=null){var s=t.replace("hh",n);return s=s.replace("h",n*1+""),s=s.replace("mm",r),s=s.replace("m",r*1+""),s=s.replace("ss",i),s=s.replace("s",i*1+""),s}return n+":"+r+":"+i},e}),define("libs/text!app/gui-components/templates/gui.component.timer.template.html",[],function(){return'<span id="timer_tmpl">\n	<%=currentTime%> / <%=duration%>\n</span>'}),define("app/gui-components/GUITimer",["krusty-core/krusty-gui/GUIComponentBase","krusty-core/krusty-util/Time","libs/text!app/gui-components/templates/gui.component.timer.template.html"],function(e,t,n){function r(r){return self=e(r),self.setTemplate(n),self.setTemplateContents({duration:"0:00:00",currentTime:"0:00:00"}),self.setDuration=function(e){this.setTmplValue("duration",t.parseTime(e,"h:mm:ss")),this.render()},self.setCurrentTime=function(e){this.setTmplValue("currentTime",t.parseTime(e,"h:mm:ss")),this.render()},self.getElement().on("touchstart",function(e){e.preventDefault()}),$("#timer_tmpl").on("touchstart",function(e){e.preventDefault()}),self}return r}),define("libs/text!app/gui-components/templates/gui.component.volume.template.html",[],function(){return'<div class="volume-slider">\n	\n</div>'}),define("app/gui-components/GUIVolumeController",["krusty-core/krusty-gui/GUIComponentBase","libs/text!app/gui-components/templates/gui.component.volume.template.html"],function(e,t){function n(n){self=e(n),self.setTemplate(t);var r=null,i=!1,s=null;return self.render=function(){var e=self.getElement();e.html(self.getTemplate()),r=e.find(".volume-slider"),r.slider({min:0,max:100,range:"min",orientation:"vertical"}),e.on("mouseover",function(){i=!0,clearTimeout(s)}),e.on("mouseleave",function(){i=!1,s=setTimeout(function(){e.hide()},1e3)}),e.hide();var t=this;r.on("slide",function(e,n){t.getContext().trigger("volumechange",t)})},self.hasFocus=function(){return i},self.setValue=function(e){r.slider("option","value",e*100)},self.getValue=function(){return r.slider("option","value")},self}return n}),define("libs/text!app/gui-components/templates/gui.component.screenshot-mask.template.html",[],function(){return'<div class="screenshot"></div>'}),define("app/gui-components/GUIScreenshotMask",["krusty-core/krusty-gui/GUIScalableMaskComponent","libs/text!app/gui-components/templates/gui.component.screenshot-mask.template.html"],function(e,t){function n(n){var r=e(n);return r.setTemplate(t),r.contextReady=function(){this.setDisplayArea(this.getChildren(".screenshot")[0]),this.setGivenRatio("4:3")},r}return n}),define("app/gui-components/config/component.mappings",["app/gui-components/GUIPresentation","app/gui-components/GUIViewport","app/gui-components/GUIControls","app/gui-components/GUIScreenshot","app/gui-components/GUIPlayback","app/gui-components/GUIDialog","app/gui-components/GUIScrubber","app/gui-components/GUIQualitySelector","app/gui-components/GUIButton","app/gui-components/GUITimer","app/gui-components/GUIVolumeController","app/gui-components/GUIScreenshotMask"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={".presentation":e,".viewport":t,".controls":n,".screenshot":r,".playback":i,".dialog":s,".scrubber":o,".quality-selector":u,".button":a,".timer":f,".volume-control":l,".screenshot-mask":c};return h}),define("krusty-core/krusty-gui/ComponentCreator",["app/gui-components/config/component.mappings"],function(e){function t(t){function i(e,t){e.jquery||(e=$(e));var n=null;$.each(r.mappings,function(t,i){e.is(t)&&(n=new r.mappings[t]({element:e}))}),n!=null&&(n.setContext(r.context),n.render(),n.setParent(t),t!=null&&t.addChild(n),r.instances.push(n))}var n=this,r={mappings:e,instances:[],context:null};return $.extend(r,t),n.createAll=function(e,t,s){e.jquery||(e=$(e)),s==null&&(s=0),i(e,t);var o=n.get("."+e[0].className)[0];if(!_.isEmpty(o)){var u=[];$.each(r.mappings,function(e,t){_.each(o.getElement().find(e),function(e){u.push(e)})}),_.each(u,function(e){n.createAll(e,o,s+1)})}return r.instances},n.get=function(e){return $(_.filter(r.instances,function(t){return t.getElement().is(e)}))},n.getInstances=function(){return r.instances},n}return t}),define("krusty-core/krusty-gui/GUIComponentContext",["backbone","krusty-core/krusty-gui/ComponentCreator"],function(e,t){function n(n){var r=this;_.extend(r,e.Events);var i={imgLocation:"",creator:new t({context:r})};return $.extend(i,n),r.getImgLocation=function(){return i.imgLocation},r.createAll=function(e,t,n){i.creator.createAll(e,t,n),_.each(i.creator.getInstances(),function(e){e.contextReady()}),r.trigger("contextready")},r.get=function(e){return i.creator.get(e)},r.resize=function(){_.each(i.creator.getInstances(),function(e){typeof e.resize=="function"&&e.resize()})},r.controls=function(e){e},r}return n}),function(e,t,n){function c(){s=t[o](function(){r.each(function(){var t=e(this),n=t.width(),r=t.height(),i=e.data(this,a);(n!==i.w||r!==i.h)&&t.trigger(u,[i.w=n,i.h=r])}),c()},i[f])}var r=e([]),i=e.resize=e.extend(e.resize,{}),s,o="setTimeout",u="resize",a=u+"-special-event",f="delay",l="throttleWindow";i[f]=250,i[l]=!0,e.event.special[u]={setup:function(){if(!i[l]&&this[o])return!1;var t=e(this);r=r.add(t),e.data(this,a,{w:t.width(),h:t.height()}),r.length===1&&c()},teardown:function(){if(!i[l]&&this[o])return!1;var t=e(this);r=r.not(t),t.removeData(a),r.length||clearTimeout(s)},add:function(t){function s(t,i,s){var o=e(this),u=e.data(this,a);u.w=i!==n?i:o.width(),u.h=s!==n?s:o.height(),r.apply(this,arguments)}if(!i[l]&&this[o])return!1;var r;if(e.isFunction(t))return r=t,s;r=t.handler,t.handler=s}}}(jQuery,this),define("jquery.resize",function(){}),define("app/Controller",["krusty-core/krusty-gui/GUICreator","config","jquery.resize"],function(e,t){function n(e){function i(){r.componentContext.on("click",n._GUIComponentClickSignalReceived),r.componentContext.on("scrub",n._GUIScrubSignalReceived),r.componentContext.on("scrubstart",n._GUIScrubStartSignalReceived),r.componentContext.on("scrubstop",n._GUIScrubStopSignalReceived),r.componentContext.on("volumechange",n._GUIVolumeChangeSignalReceived)}var n=this,r={player:null,componentContext:null};return $.extend(r,e),n.getDimensions=function(){var e=r.componentContext.get(".viewport")[0].getElement();return{left:parseFloat(e.css("left")),top:parseFloat(e.css("top")),width:parseFloat(e.width()),height:parseFloat(e.height())}},n._playerInitializingSignalReceived=function(){_refresh(),$(r.player.get("targetElement")).resize(function(){_refresh()}),i()},n._playerLoadingSignalReceived=function(e){r.componentContext.get(".dialog")[0].setIndicator("loading"),r.componentContext.get(".dialog")[0].setMessage(e)},n._playerErrorSignalReceived=function(e){r.componentContext.get(".dialog")[0].setIndicator("error"),r.componentContext.get(".dialog")[0].setMessage(e)},n._playerQualityChangedReceived=function(e){r.componentContext.get(".controls")[0].setQuality(e)},n._playerScreenshotChangeSignalReceived=function(e){$(".playback>video").show(),r.componentContext.get(".screenshot")[0].setScreenshot(e)},n._playerElementChangeSignalReceived=function(e){r.componentContext.get(".playback")[0].setVideoElement(r.player.element())},n._playerDurationKnownSignalReceived=function(e){r.componentContext.get(".timer")[0].setDuration(e),r.componentContext.get(".screenshot")[0].show()},n._playerReadyToPlaySignalReceived=function(){r.componentContext.get(".dialog")[0].setIndicator("play"),r.componentContext.get(".dialog")[0].setMessage("Click to play!")},n._playerTimeUpdateSignalReceived=function(e){r.componentContext.get(".timer")[0].setCurrentTime(e)},n._playerPercentageUpdateReceived=function(e){r.componentContext.get(".scrubber")[0].move(e)},n._playerDoneChangingQualitySignalReceived=function(){r.componentContext.get(".dialog")[0].setIndicator("play"),r.componentContext.get(".dialog")[0].setMessage("Click to play!")},n._playerPlaySignalReceived=function(){r.componentContext.get("#play-button")[0].setToggled(!0),r.componentContext.get(".playback")[0].show(),r.componentContext.get(".dialog")[0].hide(),r.componentContext.get(".screenshot")[0].hide()},n._playerPausedSignalReceived=function(){r.componentContext.get("#play-button")[0].setToggled(!1),r.componentContext.get(".dialog")[0].show()},n._playerSeekingSignalReceived=function(){r.componentContext.get(".dialog")[0].setIndicator("loading"),r.componentContext.get(".dialog")[0].setMessage("Seeking")},n._playerPlaylistEndedSignalReceived=function(){r.componentContext.get(".dialog")[0].setIndicator("play"),r.componentContext.get(".dialog")[0].setMessage("Play again!")},n._playerChangingQualitySignalReceived=function(){r.componentContext.get(".dialog")[0].setIndicator("loading"),r.componentContext.get(".dialog")[0].setMessage("Changing quality"),r.componentContext.get(".dialog")[0].show()},n._playerAspectRatioChangeSignalReceived=function(e){r.componentContext.get(".viewport")[0].setWantedRatio(e),r.componentContext.get(".viewport")[0].resize(),r.componentContext.get(".screenshot-mask")[0].setWantedRatio(e),r.componentContext.get(".screenshot-mask")[0].resize()},n._playerNativeControlsChangeSignalReceived=function(){r.player.get("nativeControls")?r.componentContext.get(".controls")[0].hide():r.componentContext.get(".controls")[0].show()},n._refresh=function(){var e=$(r.player.get("targetElement")),n=$("."+t.gui_container);n.width(e.width()),n.height(e.height()),r.componentContext.resize()},n._GUIComponentClickSignalReceived=function(e){switch(e.getElement().attr("id")){case"play-button":e.isToggled()?r.player.pause():r.player.play();break;case"volume-button":e.isToggled()?r.player.unmute():r.player.mute();break;case"dialog":e.getState()=="play"&&r.player.play();break;case"quality-1080p":r.player.quality("1080p");break;case"quality-720p":r.player.quality("720p");break;case"quality-480p":r.player.quality("480p");break;case"quality-360p":r.player.quality("360p");break;case"quality-180p":r.player.quality("180p")}},n._GUIScrubStartSignalReceived=function(){r.componentContext.get(".playback")[0].hide(),r.componentContext.get(".screenshot")[0].show(),r.player.scrubStart()},n._GUIScrubSignalReceived=function(e){r.player.scrub(e)},n._GUIScrubStopSignalReceived=function(e){r.componentContext.get(".screenshot")[0].hide(),r.player.scrubStop(e)},n._GUIVolumeChangeSignalReceived=function(e){r.player.volume(e.getValue()/100)},n}return n}),define("libs/text!app/gui-components/templates/gui.container.template.html",[],function(){return'<div class="presentation"></div>'}),define("krusty-core/krusty-gui/GUICreator",["krusty-core/krusty-gui/GUIComponentContext","app/Controller","libs/text!app/gui-components/templates/gui.container.template.html","config"],function(e,t,n,r){function i(i){function u(){s.createGUI(),o.controller=t({player:o.player,componentContext:o.componentContext}),a()}function a(){o.player.on("initialize",o.controller._playerInitializingSignalReceived),o.player.on("error",o.controller._playerErrorSignalReceived),o.player.on("qualitychanged",o.controller._playerQualityChangedReceived),o.player.on("volumechanged",o.controller._playerVolumeChangedSignalReceived),o.player.on("screenshotchanged",o.controller._playerScreenshotChangeSignalReceived),o.player.on("elementchanged",o.controller._playerElementChangeSignalReceived),o.player.on("durationknown",o.controller._playerDurationKnownSignalReceived),o.player.on("readytoplay",o.controller._playerReadyToPlaySignalReceived),o.player.on("timeupdate",o.controller._playerTimeUpdateSignalReceived),o.player.on("percentageupdate",o.controller._playerPercentageUpdateReceived),o.player.on("availablequalitieschanged",o.controller._playerAvailableQualitiesChangeSignalReceived),o.player.on("paused",o.controller._playerPausedSignalReceived),o.player.on("play",o.controller._playerPlaySignalReceived),o.player.on("seeking",o.controller._playerSeekingSignalReceived),o.player.on("loading",o.controller._playerLoadingSignalReceived),o.player.on("playlistended",o.controller._playerPlaylistEndedSignalReceived),o.player.on("changingquality",o.controller._playerChangingQualitySignalReceived),o.player.on("donechangingquality",o.controller._playerDoneChangingQualitySignalReceived),o.player.on("aspectratiochanged",o.controller._playerAspectRatioChangeSignalReceived),o.player.on("nativecontrolschanged",o.controller._playerNativeControlsChangeSignalReceived)}var s=this,o={player:null,componentContext:null,controller:null};return $.extend(o,i),s.getComponentContext=function(){return o.componentContext},s.createGUI=function(){var t=$(document.createElement("div"));t.addClass(r.gui_container),t.append(n),t.width($(o.player.get("targetElement")).width()),t.height($(o.player.get("targetElement")).height()),t.css("position","absolute"),$(o.player.get("targetElement")).append(t),o.componentContext=new e({imgLocation:o.player.get("imgLocation")}),o.componentContext.createAll(t.children().first()),o.componentContext.resize()},s.getController=function(){return o.controller},u(),s}return i}),define("krusty-core/krusty-util/EventListener",["underscore"],function(e){var t={_passThrough:function(e,t){this.trigger(e,t)},_applyCallbacks:function(t,n){if(typeof t.on!="function")throw"Object is no jQuery object";e.each(n,function(n,r){if(!e.isArray(n))throw"Callback functions are not defined as array!";n.length==0?t.on(r,function(e){this._passThrough(r,e)},this):e.each(n,function(e){t.on(r,this[e])},this)},this)},_removeCallbacks:function(t,n){if(typeof t.off!="function")throw"Object is no jQuery object";e.each(n,function(n,r){if(!e.isArray(n))throw"Callback functions are not defined as array!";n.length==0?t.off(r):e.each(n,function(e){t.off(r,this[e])},this)},this)}};return t}),window.Modernizr=function(e,t,n){function r(e){p.cssText=e}function i(e,t){return r(m.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}var a="2.6.2",f={},l=t.documentElement,c="modernizr",h=t.createElement(c),p=h.style,d,v={}.toString,m=" -webkit- -moz- -o- -ms- ".split(" "),g={},y={},b={},w=[],E=w.slice,S,x=function(e,n,r,i){var s,o,u,a,f=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(r,10))while(r--)u=t.createElement("div"),u.id=i?i[r]:c+(r+1),f.appendChild(u);return s=["&#173;",'<style id="s',c,'">',e,"</style>"].join(""),f.id=c,(h?f:p).innerHTML+=s,p.appendChild(f),h||(p.style.background="",p.style.overflow="hidden",a=l.style.overflow,l.style.overflow="hidden",l.appendChild(p)),o=n(f,e),h?f.parentNode.removeChild(f):(p.parentNode.removeChild(p),l.style.overflow=a),!!o},T={}.hasOwnProperty,N;!s(T,"undefined")&&!s(T.call,"undefined")?N=function(e,t){return T.call(e,t)}:N=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=E.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(E.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(E.call(arguments)))};return r}),g.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:x(["@media (",m.join("touch-enabled),("),c,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},g.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(r){}return n};for(var C in g)N(g,C)&&(S=C.toLowerCase(),f[S]=g[C](),w.push((f[S]?"":"no-")+S));return f.addTest=function(e,t){if(typeof e=="object")for(var r in e)N(e,r)&&f.addTest(r,e[r]);else{e=e.toLowerCase();if(f[e]!==n)return f;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(l.className+=" "+(t?"":"no-")+e),f[e]=t}return f},r(""),h=d=null,f._version=a,f._prefixes=m,f.testStyles=x,f}(this,this.document),define("libs/modernizr",function(){}),define("krusty-core/krusty-player/videoelement/VideoElement",["underscore","backbone","krusty-core/krusty-util/EventListener","libs/modernizr"],function(e,t,n){var r=t.Model.extend(n).extend({defaults:{HTMLElement:null,duration:0,preloaded:!1,playing:!1},_callbacks:{HTMLElement:{loadstart:["_loadStart"],emptied:["_emptied"],buffered:["_buffered"],canplaythrough:["_canPlayThrough"],ended:["_ended"],ratechange:["_rateChange"],progress:["_progress"],stalled:["_stalled"],playing:["_playing"],durationchange:["_durationChange"],volumechange:["_volumeChange"],suspend:["_suspend"],loadedmetadata:["_loadedMetaData"],waiting:["_waiting"],timeupdate:["_timeUpdate"],abort:["_abort"],loadeddata:["_loadedData"],seeking:["_seeking"],play:["_play"],error:["_error"],canplay:["_canPlay"],seeked:["_seeked"],pause:["_pause"]}},initialize:function(){e.bindAll(this),this._createHTMLElement(),this._parseDuration()},play:function(){this.get("HTMLElement")[0].play()},pause:function(){this.get("HTMLElement")[0].pause()},currentTime:function(e){if(e==null)return this.get("HTMLElement")[0].currentTime;this.set("wantedPosition",e);if(this.get("HTMLElement")[0].readyState>0)this.get("HTMLElement")[0].currentTime=e;else{var t=this;this.get("HTMLElement").on("loadedmetadata",function(){t.get("HTMLElement")[0].currentTime=t.get("wantedPosition")})}},volume:function(e){return e!=undefined&&(this.get("HTMLElement")[0].volume=e),this.get("HTMLElement")[0].volume},loadMetaData:function(){this.get("HTMLElement").attr("preload","metadata")},preload:function(){if(!this.get("preloaded")){if(Modernizr.touch){var e=this;e.get("HTMLElement").on("loadstart",function(){e.trigger("canplaythrough")})}this.set("preloaded",!0),$(this.get("HTMLElement")).attr("preload","auto")}},playbackRate:function(e){return e>0&&(this.get("HTMLElement")[0].playbackRate=e),this.get("HTMLElement")[0].playbackRate},_createHTMLElement:function(){if(this.get("start")!=undefined||this.get("stop")!=undefined)this.set("src",this.get("src")+"#t="),this.get("start")!=undefined&&this.set("src",this.get("src")+this.get("start")),this.get("stop")!=undefined&&this.set("src",this.get("src")+this.get("stop"));this.set("HTMLElement",$(document.createElement("video"))),this._applyCallbacks(this.get("HTMLElement"),this._callbacks.HTMLElement);var e=document.createElement("source");$(e).attr("src",this.get("src")),$(e).attr("type",this.get("type")),this.get("HTMLElement").append(e);if(this.get("src").indexOf("/progressive")!==-1&&this.get("type")=="video/mp4"){var t=this.get("src").replace("/progressive","");t=t.replace("/domain","/_definst_/mp4:domain"),t+="/playlist.m3u8",e=document.createElement("source"),$(e).attr("src",t),$(e).attr("type",this.get("type")),this.get("HTMLElement").append(e)}},_parseDuration:function(){var e=this;if(this.get("stop")!=undefined){var t="";t+="Stop: "+this.get("stop")+", ",this.get("start")!=undefined&&this.get("stop")!=undefined?(t+="Start: "+this.get("start"),this.set("duration",this.get("stop")-this.get("start"))):this.get("stop")!=undefined&&(t+="Start: not defined",this.set("duration",this.get("stop"))),setTimeout(function(){e.trigger("durationknown",e)},50)}else if(this.get("start")!=undefined&&this.get("stop")==undefined){var t="Start: "+this.get("start")+", Stop: undefined, load metadata to get duration";this.get("HTMLElement").on("loadedmetadata",function(t){e.set("duration",parseFloat(t.target.duration)-e.get("start"));var n="Metadata loaded, duration: "+e.get("duration");e.set("stop",parseFloat(t.target.duration)),e.trigger("durationknown",e),$(e.get("HTMLElement")).off("loadedmetadata",this)}),this.loadMetaData()}else{var t="Start: undefined, Stop: undefined, load metadata to get duration";this.get("HTMLElement").on("loadedmetadata",function(t){e.set("duration",parseFloat(t.target.duration));var n="Metadata loaded, duration: "+e.get("duration");e.set("start",0),e.set("stop",parseFloat(t.target.duration)),e.set("duration",parseFloat(t.target.duration)),e.trigger("durationknown",e),e.get("HTMLElement").off("loadedmetadata",this)}),this.loadMetaData()}},getHTMLElement:function(){return this.get("HTMLElement")},_loadStart:function(e){this.trigger("loadstart",this)},_loadedMetaData:function(e){this.trigger("loadedmetadata",this)},_canPlayThrough:function(e){this.trigger("canplaythrough",this)},_durationChange:function(e){this.trigger("durationchange",this)},_timeUpdate:function(e){this.trigger("timeupdate",this)},_ended:function(e){this.trigger("ended",this)},_play:function(e){this.set("playing",!0),this.trigger("play",this)},_pause:function(e){this.get("stop")>0?this.currentTime()>this.get("stop")?this.trigger("fragmentended",this):(this.set("playing",!1),this.trigger("pause",this)):(this.set("playing",!1),this.trigger("pause",this))},_waiting:function(e){},_buffered:function(e){},_seeking:function(e){this.trigger("seeking",this)},_seeked:function(e){this.trigger("seeked",this)}},{canCreate:function(e){switch(e){case"video/mp4":return Modernizr.video.h264;case"video/webm":return Modernizr.video.webm;case"video/youtube":return!0;case"video/vimeo":return!0}},createVideoElement:function(e){if(!r.canCreate(e.type))throw"VideoElement: Can't create element for source: "+e.src+", of type: "+e.type+", codec not supported by browser.";switch(e.type){case"video/mp4":return new r({src:e.src,type:e.type});case"video/webm":return new r({src:e.src,type:e.type});case"video/youtube":return new YoutubeElement({src:e.src});case"video/vimeo":return new VimeoElement({src:e.src})}}});return r}),define("krusty-core/krusty-player/videoelement/YoutubeElement",["underscore","backbone","krusty-core/krusty-util/EventListener","libs/modernizr"],function(e,t,n){var r=t.Model.extend(n).extend({defaults:{youtubePlayer:null,HTMLElement:null,duration:0,preloaded:!1,playing:!1,youtubeid:null,timeupdater:null,availableQualities:[],initialPlayoutDone:!1},_callbacks:{},initialize:function(){e.bindAll(this),this._createHTMLElement()},play:function(){this.get("youtubePlayer").playVideo()},pause:function(){this.get("youtubePlayer").pauseVideo()},currentTime:function(e){if(this.get("youtubePlayer"))if(e)this.get("youtubePlayer").seekTo(e,!0);else if(this.get("youtubePlayer").getCurrentTime)return this.get("youtubePlayer").getCurrentTime()},volume:function(e){if(e||e==0)this.get("youtubePlayer").setVolume&&this.get("youtubePlayer").setVolume(e*100);else if(this.get("youtubePlayer").getVolume)return this.get("youtubePlayer").getVolume()/100},playbackRate:function(e){return e=parseFloat(e),this.get("youtubePlayer").setPlaybackRate(e),this.get("youtubePlayer").getPlaybackRate()},loadMetaData:function(){},preload:function(){},_createHTMLElement:function(){function t(){e.set("youtubePlayer",new YT.Player(e.get("HTMLElement").attr("id"),{videoId:e.get("youtubeid"),playerVars:{controls:"0"},events:{onReady:function(){e._initialPlayout()}}}))}var e=this;this.set("HTMLElement",$(document.createElement("div"))),this.get("HTMLElement").attr("id","youtube-player-"+this.get("youtubeid")),$("#youtube-container").append(this.get("HTMLElement")),t(),this.set("HTMLElement",$("iframe#youtube-player-"+this.get("youtubeid")))},_parseDuration:function(){var e=this;this.get("youtubePlayer").getDuration&&this.get("youtubePlayer").getDuration()>0&&(e.set("duration",this.get("youtubePlayer").getDuration()),e.trigger("durationknown",e)),this.get("duration")==0&&(youtubeFeedCallback=function(t){e.set("duration",t.data.duration),e.trigger("durationknown",e)},$.ajax({url:"http://gdata.youtube.com/feeds/api/videos/"+this.get("youtubeid")+"?v=2&alt=jsonc&callback=youtubeFeedCallback"}))},_initialPlayout:function(){var e=this,t=function(t){switch(e.get("youtubePlayer").getPlayerState()){case YT.PlayerState.PLAYING:e.get("initialPlayoutDone")||(e.set("initialPlayoutDone",!0),e.pause(),e._parseDuration(),e._canPlayThrough(),e._applyCallbacks(),e.currentTime(0))}};e.get("youtubePlayer").addEventListener("onStateChange",t),e.play()},_applyCallbacks:function(){var e=this;e.get("youtubePlayer").addEventListener("onStateChange",function(t){switch(e.get("youtubePlayer").getPlayerState()){case YT.PlayerState.PLAYING:e._play();break;case YT.PlayerState.PAUSED:e._pause()}})},quality:function(e){var t=this;if(e){var n="";switch(e){case"180p":n="small";break;case"360p":n="medium";break;case"480p":n="large";break;case"720p":n="hd720";break;case"1080p":n="hd1080"}if(!this.get("youtubePlayer").setPlaybackQuality){this.set("wantedQuality",e);var r=function(){t.get("wantedQuality")&&(t.quality(t.get("wantedQuality")),t.set("wantedQuality",null)),r=null};this.get("youtubePlayer").addEventListener("onReady",r),this.get("youtubePlayer").addEventListener("onPlaybackQualityChange",this._onQualityChanged)}else this.get("youtubePlayer").getPlayerState()==YT.PlayerState.PLAYING&&this.pause(),this.get("youtubePlayer").setPlaybackQuality(n)}},getHTMLElement:function(){return this.get("HTMLElement")},_loadStart:function(e){this.trigger("loadstart",this)},_loadedMetaData:function(e){this.trigger("loadedmetadata",this)},_canPlayThrough:function(e){this.trigger("canplaythrough",this)},_onQualityChanged:function(){this.get("timeBeforeQualityChanged")>0&&(this.currentTime(this.get("timeBeforeQualityChanged")),this.set("timeBeforeQualityChange",0)),this.trigger("donechangingquality",this)},_timeUpdate:function(e){this.trigger("timeupdate",this)},_ended:function(e){this.trigger("ended",this)},_play:function(e){this.set("playing",!0),this.get("timeupdater")||this.set("timeupdater",setInterval(this._timeUpdate,250)),this.trigger("play",this)},_pause:function(e){this.get("stop")>0?this.currentTime()>this.get("stop")?this.trigger("fragmentended",this):(this.set("playing",!1),this.trigger("pause",this)):(this.set("playing",!1),this.trigger("pause",this)),clearInterval(this.get("timeupdater")),this.set("timeupdater",null)},_waiting:function(e){},_seeking:function(e){this.trigger("seeking",this)},_seeked:function(e){this.trigger("seeked",this)}});return r}),define("krusty-core/krusty-player/playlist/PlaylistItem",["underscore","backbone","krusty-core/krusty-util/EventListener","krusty-core/krusty-player/videoelement/VideoElement","krusty-core/krusty-player/videoelement/YoutubeElement"],function(e,t,n,r,i){var s=t.Model.extend(n).extend({self:this,justSwitchedQuality:!1,changeTimeToWhenPlaying:0,defaults:{title:null,active:!1,start:undefined,stop:undefined,_currentTime:null,currentAbsoluteTime:null,sources:null,currentSource:null,duration:0,playlistStart:0,playlistStop:0,screenshots:null,aspectRatio:null,anamorphic:!1,scrubbing:!1},_callbacks:{"this":{"change:active":["_activeChanged"]},element:{active:{play:["_play"],pause:["_pause"],loadedmetadata:["_loadedMetaData"],canplaythrough:["_canPlayThrough"],timeupdate:["_timeUpdate"],seeked:["_seeked"],ended:["_ended"]},always:{durationknown:["_durationKnown"],loadstart:["_loadStart"],canplaythrough:["_canPlayThrough"]}}},initialize:function(){e.bindAll(this),this.get("start")!=undefined&&this.get("stop")!=undefined?this.set("duration",parseFloat(this.get("stop")-this.get("start"))):this.get("stop")!=undefined&&this.set("duration",this.get("stop"));var t=this;this.get("duration")!=0&&setTimeout(function(){t.trigger("itemdurationknown",t)},10),this._applyCallbacks(this,this._callbacks["this"])},play:function(){this.get("currentSource").get("element").play()},getAvailableQualities:function(){return this.get("currentSource").get("element")instanceof i?this.get("currentSource").get("element").get("availableQualities"):e.map(this.get("sources"),function(e){return e.get("quality")})},pause:function(){this.get("currentSource").get("element").pause()},volume:function(e){return e!=undefined&&this.get("currentSource").get("element").volume(e),this.get("currentSource").get("element").volume()},duration:function(){this.get("currentSource").get("element").duration()},currentTime:function(e){if(e==null)return this.get("currentTime");this.get("start")!=undefined&&(e+=this.get("start"));if(this.get("currentSource")==null)throw"PlaylistItem: No current source set yet.";this.get("currentSource").get("element")instanceof i?this.get("currentSource").get("element").currentTime(e):this.get("scrubbing")?(this.set("currentTime",e),this.trigger("timeupdate",this)):this.get("currentSource").get("element").currentTime(e)},selectSourceByQuality:function(e){this.trigger("changingquality",this),this.get("sources")[0].get("element")instanceof r?this._selectInternalSourceByQuality(e):this.get("sources")[0].get("element")instanceof i&&this._selectYoutubeSourceQuality(e)},playbackRate:function(e){return this.get("currentSource").get("element").playbackRate(e)},_selectInternalSourceByQuality:function(t){var n=this,r=!1;this.get("currentSource")!=null&&(this._removeCallbacks(this.get("currentSource"),this._callbacks.element.always),this.get("currentSource").get("element").get("playing")&&(r=!0,this.get("currentSource").get("element").pause()));var i=this.get("currentSource"),s=e.find(this.get("sources"),function(e){return parseInt(e.get("quality"))==parseInt(t)});s==null&&(s=e.first(this.get("sources"))),this.set("currentSource",s),this.get("currentSource").get("element").preload(),this._applyCallbacks(this.get("currentSource"),this._callbacks.element.always),this.get("active")&&this._applyCallbacks(this.get("currentSource"),this._callbacks.element.active),i!=null&&setTimeout(function(){n.get("currentSource").get("element").currentTime(i.get("element").currentTime()),n.trigger("donechangingquality",this),r&&n.get("currentSource").get("element").play()},1e3)},_selectYoutubeSourceQuality:function(e){var t=this,n=!1,r=0;this.get("currentSource")==null&&(this.set("currentSource",this.get("sources")[0]),this._applyCallbacks(this.get("currentSource"),this._callbacks.element.always),this._applyCallbacks(this.get("currentSource"),this._callbacks.element.active)),this.get("currentSource").get("element").get("playing")&&(n=!0),r=this.get("currentSource").get("element").currentTime();var i=function(){t.get("currentSource").off("donechangingquality",i),t.trigger("donechangingquality",t),n&&setTimeout(function(){t.get("currentSource").get("element").currentTime(r),n&&t.get("currentSource").get("element").play()},1e3)};this.get("currentSource").on("donechangingquality",i),this.get("currentSource").get("element").quality(e)},getVideoElement:function(){return this.get("currentSource").get("element").get("HTMLElement")},getScreenshotURI:function(e){if(this.get("screenshots")){this.get("start")!=undefined&&(e+=this.get("start"));var t=Math.floor(e/3600),n=Math.floor((e-t*3600)/60),r=Math.floor(e-t*3600-n*60);return this.get("screenshots")+"/h/"+t+"/m/"+n+"/sec"+r+".jpg"}},preload:function(){this.get("currentSource").get("element").preload()},_activeChanged:function(e,t,n){this.get("active")?this._applyCallbacks(this.get("currentSource").get("element"),this._callbacks.element.active):this._removeCallbacks(this.get("currentSource").get("element"),this._callbacks.element.active)},_loadStart:function(e){this.trigger("loadstart",this)},_loadedMetaData:function(e){this.trigger("loadedmetadata",this)},_canPlayThrough:function(e){this.trigger("canplaythrough",this)},_play:function(e){this.changeTimeToWhenPlaying>0&&(this.get("currentSource").get("element").currentTime(this.changeTimeToWhenPlaying),this.changeTimeToWhenPlaying=0),this.trigger("play",this)},_pause:function(e){this.trigger("pause",this)},_durationKnown:function(e){this.get("duration")!=e.get("duration")&&(this.get("start")!=undefined?this.set("duration",e.get("duration")-this.get("start")):this.set("duration",e.get("duration")),this.trigger("itemdurationknown",this))},_timeUpdate:function(e){var t=e.currentTime();this.set("currentAbsoluteTime",e.currentTime());if(t>this.get("stop")&&this.get("stop")>0&&this.get("active"))this.trigger("ended",this);else{if(this.get("start")!=undefined){if(t<this.get("start")-1&&this.get("active"))return e.currentTime(this.get("start")),!1;t-=this.get("start")}this.set("currentTime",t),this.trigger("timeupdate",this)}},_seeked:function(t){e.isEqual(t,this.get("currentSource").get("element"))&&this.trigger("seeked",this)},_ended:function(t){e.isEqual(t,this.get("currentSource").get("element"))&&this.trigger("ended",this)}});return s}),define("krusty-core/krusty-player/playlist/Playlist",["underscore","backbone","krusty-core/krusty-player/playlist/PlaylistItem","krusty-core/krusty-util/EventListener"],function(e,t,n,r){var i=t.Model.extend(r).extend({logObjectName:"Playlist",defaults:{items:null,duration:null,quality:null,currentItem:null,currentTime:null,currentPercentage:null,currentVolume:1,scrubbing:!1},_callbacks:{"this":{"change:items":["_itemsChanged"]},playlistItem:{current:{canplaythrough:["_currentItemCanPlayThrough"],loadedmetadata:["_currentItemLoadedMetaData"],timeupdate:["_timeUpdate"],itemalmostdone:["_itemAlmostDone"],ended:["_itemEnded"],play:["_play"],pause:["_pause"],seeked:["_seeked"],changingquality:[],donechangingquality:[]},all:{itemdurationknown:["_durationKnown"]}}},initialize:function(){e.bindAll(this),this._applyCallbacks(this,this._callbacks["this"])},play:function(){this.get("currentItem").play()},pause:function(){this.get("currentItem").pause()},scrubStart:function(){this.set("scrubbing",!0),this.get("currentItem").set("scrubbing",!0),this.pause()},element:function(){return this.get("currentItem").get("currentSource").get("element")},currentTime:function(t){if(t){var n=this._getItemForPlaylistTime(t);if(!e.isEqual(n,this.get("currentItem"))){var r=this.get("currentItem");this.select(n),r.get("scrubbing")&&(r.set("scrubbing",!1),this.get("currentItem").set("scrubbing",!0))}var i=t-n.get("playlistStart");this.get("currentItem").currentTime(i)}return this.get("currentTime")},scrubTo:function(e){e<1&&(e=1);var t=parseFloat(this.get("duration")/100*e);this.currentTime(t)},scrubStop:function(e){this.set("scrubbing",!1),this.get("currentItem").set("scrubbing",!1),e<1&&(e=1);var t=parseFloat(this.get("duration")/100*e);this.currentTime(t),this.play()},volume:function(e){if(e||e==0)this.set("currentVolume",e),this.get("currentItem").volume(e);return this.get("currentVolume")},chooseQuality:function(t){t&&(e.invoke(this.get("items"),"selectSourceByQuality",t),this.set("quality",t))},select:function(t,n){var r=null;this.get("currentItem")!=null&&(this.get("currentItem").set("active",!1),r=this.get("currentItem"),this._removeCallbacks(this.get("currentItem"),this._callbacks.playlistItem.current)),this.set("currentItem",t),this.get("currentItem").set("active",!0),this.get("currentItem").currentTime(0),this.get("currentItem").volume(this.get("currentVolume")),this._applyCallbacks(this.get("currentItem"),this._callbacks.playlistItem.current),r!=null?(e.isEqual(r.get("currentSource").get("element"),this.get("currentItem").get("currentSource").get("element"))||r.get("aspectRatio")!=this.get("currentItem").get("aspectRatio")&&this.trigger("aspectratiochanged",this.get("currentItem").get("aspectRatio")),this.trigger("elementswitched",t)):this.trigger("aspectratiochanged",this.get("currentItem").get("aspectRatio")),n&&this.get("currentItem").play()},selectFirst:function(){this.select(this.get("items")[0])},getScreenshotURI:function(t){var n=e.find(this.get("items"),function(e){return e.get("playlistStart")<t&&e.get("playlistStop")>t||e.get("playlistStart")==t});return n.getScreenshotURI(t-n.get("playlistStart"))},preload:function(){var t=[];e.each(this.get("items"),function(e){e.preload()},this)},getAvailableQualities:function(){return this.get("currentItem").getAvailableQualities()},playbackRate:function(e){return this.get("currentItem").playbackRate(e)},_getItemForPlaylistTime:function(t){return e.find(this.get("items"),function(e){return e.get("playlistStart")<t&&e.get("playlistStop")>t})},_itemsChanged:function(){e.each(this.get("items"),function(e){this._applyCallbacks(e,this._callbacks.playlistItem.all)},this)},_durationKnown:function(t){if(this.get("duration")==null){var n=!0,r=0;e.each(this.get("items"),function(e){e.get("duration")==0?n=!1:r+=parseFloat(e.get("duration"))});if(n){this.set("duration",r);var i=0;e.each(this.get("items"),function(e){e.set("playlistStart",i),e.set("playlistStop",parseFloat(e.get("playlistStart")+e.get("duration"))),i+=e.get("duration")}),this.trigger("durationknown",this.get("duration"))}}},_currentItemCanPlayThrough:function(e){e.get("active")&&this.trigger("itemcanplay")},_timeUpdate:function(e){if(e.get("active")){var t=e.get("currentTime");this.set("currentTime",t+e.get("playlistStart"));if(this.get("duration")!=null){var n=parseFloat((t+e.get("playlistStart"))/this.get("duration"))*100;n==NaN?this.set("currentPercentage",0):this.set("currentPercentage",n)}this.trigger("playlisttimeupdate",this)}},_itemEnded:function(t){if(t.get("active")){var n=this.get("items")[e.indexOf(this.get("items"),this.get("currentItem"))+1];(n==undefined||!e.isEqual(n.get("currentSource").get("element"),this.get("currentItem").get("currentSource").get("element")))&&this.get("currentItem").pause(),n!=undefined?this.select(n,!0):this.trigger("playlistended")}},_play:function(e){e.get("active")&&this.trigger("play")},_pause:function(e){e.get("active")&&this.trigger("pause")}});return i}),define("krusty-core/krusty-player/playlist/VideoSource",["backbone","krusty-core/krusty-util/EventListener"],function(e,t){var n=e.Model.extend(t).extend({logObjectName:"VideoSource",defaults:{element:null,codecs:[],quality:""},_callbacks:{element:{play:[],pause:[],durationknown:[],loadstart:[],loadedmetadata:[],canplaythrough:[],timeupdate:[],absolutetimeupdate:[],fragmentended:[],fragmentalmostdone:[],seeked:[],ended:[],qualitylevelsknown:[],donechangingquality:[]}},initialize:function(){this.get("element")!=null&&this._applyCallbacks(this.get("element"),this._callbacks.element)}});return n}),define("krusty-core/krusty-player/playlist/VideoSourceCollection",["backbone","krusty-core/krusty-player/playlist/VideoSource"],function(e,t){var n=e.Collection.extend({lobObjectName:"VideoSourceCollection",model:t});return n}),define("krusty-core/krusty-player/videoelement/VimeoElement",function(){}),define("krusty-core/krusty-player/playlist/PlaylistParser",["underscore","backbone","krusty-core/krusty-player/playlist/Playlist","krusty-core/krusty-player/playlist/PlaylistItem","krusty-core/krusty-player/playlist/VideoSource","krusty-core/krusty-player/playlist/VideoSourceCollection","krusty-core/krusty-player/videoelement/VideoElement","krusty-core/krusty-player/videoelement/YoutubeElement","krusty-core/krusty-player/videoelement/VimeoElement"],function(e,t,n,r,i,s,o,u,a){var f=t.Model.extend({defaults:{playlist:null,_playlist:null},initialize:function(){this._parse()},_parse:function(){var t=this,r=this.get("playlist").splice(0),i=0;e.each(r,function(e){e.order=i,i++}),this.set("_playlist",new n);var s=this._parseInternalSources(r),o=this._parseExternalSources(r),u=[];e.extend(u,s,o),t.get("_playlist").set("items",u)},_parseInternalSources:function(t){var n=[];e.each(t,function(t){e.each(t.sources,function(r){r.codecs&&e.each(r.codecs,function(e){e.item=t,e.quality=r.quality,t.start!=undefined&&(e.start=t.start),t.stop!=undefined&&(e.stop=t.stop),n.push(e)})})});if(n.length>0){var s=e.groupBy(n,function(e){return e.src});e.each(s,function(t,n){if(t.length==1){var r={src:n,type:t[0].type};t[0].start!=undefined&&(r.start=t[0].start),t[0].stop!=undefined&&(r.stop=t[0].stop);try{var i=o.createVideoElement(r),s=e.find(t[0].item.sources,function(e){return e.quality==t[0].quality});s.element==undefined&&(s.element=i)}catch(u){console.log(u)}}else try{var i=o.createVideoElement({src:n,type:t[0].type});e.each(t,function(t){var n=e.find(t.item.sources,function(e){return e.quality==t.quality});n.element==undefined&&(n.element=i)})}catch(u){console.log(u)}});var u=[];e.each(t,function(t){var n=0;e.each(t.sources,function(r){r.element==undefined&&t.sources.splice(e.indexOf(t.sources,r)),t.sources[n]=new i(r),n++});if(t.sources.length>0){var s={title:t.title,sources:t.sources,order:t.order};t.start!=undefined&&(s.start=t.start),t.stop!=undefined&&(s.stop=t.stop),t.screenshots!=undefined&&(s.screenshots=t.screenshots),t.aspectRatio!=undefined&&(s.aspectRatio=t.aspectRatio),t.anamorphic!=undefined&&(s.anamorphic=t.aspectRatio),u.push(new r(s))}})}return u},_parseExternalSources:function(t){var n=this,r=[];return e.each(t,function(e){if(e.type)switch(e.type){case"video/youtube":r.push(n._createYoutubeItem(e))}}),r},_createYoutubeItem:function(e){var e=new r({start:e.start,stop:e.stop,screenshots:e.screenshots,sources:[new i({element:new u({youtubeid:e.youtubeid,availableQualities:e.availableQualities})})],order:e.order});return e},getPlaylist:function(){return this.get("_playlist")}});return f}),define("krusty-core/krusty-player/HTML5Player",["underscore","backbone","krusty-core/krusty-player/playlist/Playlist","krusty-core/krusty-player/playlist/PlaylistParser","krusty-core/krusty-util/EventListener"],function(e,t,n,r,i){var s=t.Model.extend(i).extend({defaults:{playlistData:null,playlist:null,screenshot:null,componentContext:{},targetElement:null,defaultQuality:"720p",changingQuality:!1,nativeControls:!0,eventInterval:{timeupdate:250,volumechanged:250},prevVolume:0,ended:!1,playing:!1},_callbacks:{"this":{"change:playlistData":["_parsePlaylist"],"change:nativeControls":["_nativeControlsChanged"]},playlist:{loadstart:["_loadStart"],durationknown:["_durationKnown"],itemcanplay:["_itemCanPlay"],playlisttimeupdate:["_timeUpdate"],elementswitched:["_elementSwitched"],play:["_play"],pause:["_pause"],"playlist-initialized":["_test"],playlistended:["_playlistEnded"],changingquality:["_changingQuality"],donechangingquality:["_doneChangingQuality"],aspectratiochanged:["_aspectRatioChanged"],qualitylevelsknown:["_qualityLevelsKnown"]}},blockEvent:{timeupdate:!1,volumechanged:!1},initialize:function(){e.bindAll(this)},start:function(){var e=this;this.on("externalapisloaded",function(){e.trigger("initialize",e),e.on("readytoplay",function(){$(e.get("targetElement")).trigger("readytoplay")}),e.on("presentationloaded",function(){$(e.get("targetElement")).trigger("presentationloaded")});try{e._applyCallbacks(e,e._callbacks["this"])}catch(t){console.log(t)}e.get("playlistData")!=null&&e._parsePlaylist(),e.get("nativeControls")||e._nativeControlsChanged(),e.off("externalapisloaded")}),e._loadExternalAPIs()},play:function(){var e=0;this.get("ended")&&(this.get("playlist").selectFirst(),this.set("ended",!1),e=100);var t=this;setTimeout(function(){t.get("playlist").play()},e)},pause:function(){this.get("playlist").pause()},volume:function(e){if(e!=undefined){this.trigger("volumechanged",e);if(!this.blockEvent.volumechanged||e==0){$(this.get("targetElement")).trigger("volumechanged",e),this.blockEvent.volumechanged=!0;var t=this;setTimeout(function(){t.blockEvent.volumechanged=!1},this.get("eventInterval").volumechanged)}}return this.get("playlist").volume(e)},element:function(){return this.get("playlist").element().getHTMLElement()},mute:function(){this.set("prevVolume",this.get("playlist").volume()),this.volume(0)},unmute:function(){this.volume(this.get("prevVolume"))},error:function(e){this.trigger("error",e)},quality:function(e){return e&&(e!=this.get("playlist").get("quality")&&(this.get("playlist").chooseQuality(e),this._loadElement()),this.set("changingQuality",!0),this.trigger("qualitychanged",e)),this.get("playlist").get("quality")},currentTime:function(e){return this.get("playlist").currentTime(e)},duration:function(){return this.get("playlist").get("duration")},isPlaying:function(){return this.get("playing")},refresh:function(){var e=this;e.get("componentContext").get(".presentation")[0].setDimensions({width:$(window).width(),height:$(window).height()}),e.get("componentContext").resize()},isPlaying:function(){return this.get("playing")},playbackRate:function(e){return this.get("playlist").playbackRate(e)},_parsePlaylist:function(){this.trigger("loading");if(this.get("playlistData")!=null){var e=new r({playlist:this.get("playlistData")});this.set("playlist",e.getPlaylist());try{this.get("playlist").chooseQuality(this.get("defaultQuality")),this._preloadPlaylist(),this._applyCallbacks(this.get("playlist"),this._callbacks.playlist),this.get("playlist").selectFirst(),this.trigger("volumechanged",this.get("playlist").get("currentVolume")),this._loadElement(),this._updateAvailableQualities()}catch(t){console.log(t.stack)}}},_loadExternalAPIs:function(){var e=this;if(!window.YT){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src","http://www.youtube.com/iframe_api"),document.getElementsByTagName("head")[0].appendChild(t),window.onYouTubeIframeAPIReady=function(){e.trigger("externalapisloaded")}}else e.trigger("externalapisloaded")},_preloadPlaylist:function(){this.get("playlist").preload()},_loadScreenshot:function(e){e&&this.trigger("screenshotchanged",e)},_loadElement:function(){this.trigger("elementchanged")},_durationKnown:function(e){this.trigger("durationknown",e),this._loadScreenshot(this.get("playlist").getScreenshotURI(1))},_itemCanPlay:function(){!this.get("changingQuality")&&!this.get("playlist").get("scrubbing")&&!this.get("ended")&&(this.trigger("presentationloaded"),this.trigger("readytoplay"))},_componentClicked:function(e){switch(e.getElement().attr("id")){case"play-button":e.isToggled()?this.pause():this.play();break;case"volume-button":e.isToggled()?this.unmute():this.mute();break;case"dialog":e.getState()=="play"&&this.play();break;case"quality-1080p":this.quality("1080p");break;case"quality-720p":this.quality("720p");break;case"quality-480p":this.quality("480p");break;case"quality-360p":this.quality("360p");break;case"quality-180p":this.quality("180p")}},_volumeChange:function(e){this.volume(e.getValue()/100)},_timeUpdate:function(e){this.trigger("timeupdate",e.get("currentTime")),this.get("playlist").get("currentPercentage")>0&&!this.get("playlist").get("scrubbing")&&this.trigger("percentageupdate",this.get("playlist").get("currentPercentage"));if(!this.blockEvent.timeupdate){$(this.get("targetElement")).trigger("timeupdate",e.get("currentTime")),this.blockEvent.timeupdate=!0;var t=this;setTimeout(function(){t.blockEvent.timeupdate=!1},this.get("eventInterval").timeupdate)}},_elementSwitched:function(){this._loadElement(),this._updateAvailableQualities()},_updateAvailableQualities:function(){this.trigger("availablequalitieschanged",this.get("playlist").getAvailableQualities())},scrubStart:function(){var e=this;this.get("playlist").scrubStart()},scrub:function(e){this.get("playlist").scrubTo(e),this._loadScreenshot(this.get("playlist").getScreenshotURI(this.get("playlist").get("currentTime")))},scrubStop:function(e){this.trigger("timeupdate",this.get("playlist").get("currentTime")),this.get("playlist").scrubStop(e)},_play:function(){this.trigger("play"),$(this.get("targetElement")).trigger("play"),this.set("playing",!0)},_pause:function(){this.get("playlist").get("scrubbing")?this.trigger("seeking"):this.get("changingQuality")?this.trigger("loading","Loading!"):this.get("ended")||this.trigger("readytoplay"),this.trigger("paused"),$(this.get("targetElement")).trigger("pause"),this.set("playing",!1),this.set("playing",!1)},_playlistEnded:function(){this.set("ended",!0),this.trigger("playlistended"),$(this.get("targetElement")).trigger("playlistended")},_changingQuality:function(e){this.trigger("changingquality"),$(this.get("targetElement")).trigger("changingquality")},_doneChangingQuality:function(e){this.set("changingQuality",!1),this.trigger("readytoplay"),$(this.get("targetElement")).trigger("donechangingquality",this.get("playlist").get("quality"))},_aspectRatioChanged:function(e){this.trigger("aspectratiochanged",e),$(this.get("targetElement")).trigger("aspectratiochanged",e)},_nativeControlsChanged:function(){this.trigger("nativecontrolschanged"),$(this.get("targetElement")).trigger("nativecontrolschanged",this.get("nativeControls"))},setPoster:function(e){$(".playback>video").hide(),e+="/h/0/m/0/sec1.jpg";var t=$(".screenshot");$(".screenshot>img").css("width",t.width()+"px"),$(".screenshot>img").css("height",t.height()+"px"),$(".screenshot>img").attr("src",e)}});return s}),requirejs.config({baseUrl:"js/krusty",paths:{"jquery.resize":"libs/jquery.resize.min",config:"app/config/settings",underscore:"libs/underscore",backbone:"libs/backbone"},shim:{backbone:{deps:["underscore"],exports:"Backbone"}}}),define("app/jquery.krusty",["krusty-core/krusty-util/Url","krusty-core/springfield/bart/QuickStartConnector","krusty-core/krusty-player/bart/QSResponseParser","krusty-core/springfield/bart/BartResponseParser","krusty-core/krusty-gui/GUICreator","krusty-core/krusty-player/HTML5Player"],function(e,t,n,r,i,s){(function(e){jQuery.fn.krusty=function(t){if(r[t])return r[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return r.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.krusty")};var r={init:function(r){r==undefined&&(r={}),this.each(function(){var o=this,u={imgLocation:r.imgLocation,eventInterval:r.eventInterval,targetElement:this};_.each(u,function(e,t){e==undefined&&delete u[t]});var a=new s(u);e(this).data("player",a);var f=i({player:a}),l=f.getController();e(this).data("controller",l),a.start();if(r.uri)try{var c=t({uri:r.uri,success:function(e){var t=n.parse(e),r=t[0].screenshots;a.set("playlistData",t),r!=null&&a.setPoster(r)}})}catch(h){a.error(h)}})},nativeControls:function(t){return this.each(function(){e(this).data("player").set("nativeControls",t)}),e(e(this).first()).data("player").get("nativeControls")},duration:function(){return e(e(this).first()).data("player").duration()},isPlaying:function(){return e(e(this).first()).data("player").isPlaying()},dimensions:function(){return e(e(this).first()).data("controller").getDimensions()},play:function(){this.each(function(){e(this).data("player").play()})},pause:function(){this.each(function(){e(this).data("player").pause()})},quality:function(t){this.each(function(){e(this).data("player").quality(t)})},mute:function(){this.each(function(){e(this).data("player").mute()})},unmute:function(){this.each(function(){e(this).data("player").mute()})},volume:function(t){return t<=1&&t>=0&&this.each(function(){e(this).data("player").volume(t)}),e(e(this).first()).data("player").volume()},currentTime:function(t){return this.each(function(){e(this).data("player").currentTime(t)}),e(e(this).first()).data("player").currentTime()},volumeOf:function(){return e(e(this).first()).data("player").volume()},scrubStart:function(){this.each(function(){e(this).data("player").scrubStart()})},scrub:function(t){this.each(function(){e(this).data("player").scrub(t)})},scrubStop:function(t){this.each(function(){e(this).data("player").scrubStop(t)})},error:function(t){return e(e(this).first()).data("player").error(t)},refresh:function(){this.each(function(){e(this).data("player").refresh()})},playbackRate:function(t){return this.each(function(){e(this).data("player").playbackRate(t)}),e(e(this).first()).data("player").playbackRate()}};jQuery.holdReady(!1)})(jQuery)}),require(["app/jquery.krusty"])